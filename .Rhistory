library("tidyverse")
library("janitor")
library("naniar")
sharks <- read_csv("data/SharkIncidents_1950_2022_220302.csv") %>% clean_names()
glimpse(sharks)
View(sharks)
summary(sharks)
head(sharks)
tail(sharks)
sharks <- sharks %>%
replace_with_na(replace = list(incident_num = "NOT COUNTED",
time = "Unknown"))
sharks <- sharks %>%
replace_with_na(replace = list(incident_num = "NOT COUNTED",
time = "Unknown",
species = "Unknown"))
sharks %>%
ggplot(aes(x = county))+
geom_bar()
sharks %>%
ggplot(aes(x = county))+
geom_bar()+
coord_flip()
sharks %>%
ggplot(aes(x = reorder(county))+
geom_bar()+
coord_flip()+
sharks %>%
ggplot(aes(x = reorder(county, count))+
geom_bar()+
coord_flip()+
sharks %>%
ggplot(aes(x = reorder(county))+
geom_bar()+
coord_flip()+
sharks %>%
ggplot(aes(x = county))+
geom_bar()+
coord_flip()+
sharks %>%
ggplot(aes(x = county))+
geom_bar()+
coord_flip()
sharks %>%
ggplot(aes(x = county))+
geom_bar()+
coord_flip()+
labs(title = "Incidents by County", x = "County", y = "Count")+
theme(plot.title=element_text(size=rel(1.5), hjust=.5))
sharks%>%
mutate(month = as.factor(month)) %>%
ggplot(aes(x = month))+
geom_bar()
sharks%>%
mutate(month = as.factor(month)) %>%
ggplot(aes(x = month))+
geom_bar()+
labs(title = "Incidents by Month", x = "Month", y = "Count")+
theme(plot.title=element_text(size=rel(1.5), hjust=.5))
sharks%>%
#mutate(month = as.factor(month)) %>%
ggplot(aes(x = month))+
geom_bar()+
labs(title = "Incidents by Month", x = "Month", y = "Count")+
theme(plot.title=element_text(size=rel(1.5), hjust=.5))
#October has the highest number of incidents
sharks%>%
mutate(month = as.factor(month)) %>%
ggplot(aes(x = month))+
geom_bar()+
labs(title = "Incidents by Month", x = "Month", y = "Count")+
theme(plot.title=element_text(size=rel(1.5), hjust=.5))
#October has the highest number of incidents
sharks %>%
group_by(county) %>%
select(county, injury)
sharks %>%
mutate(injury = as.factor(injury)) %>%
group_by(county) %>%
summarize(counts = n())
sharks %>%
mutate(injury = as.factor(injury)) %>%
group_by(county, injury) %>%
summarize(counts = n())
sharks %>%
mutate(injury = as.factor(injury)) %>%
group_by(county, injury) %>%
summarize(counts = n(), .groups = 'keep')
sharks %>%
mutate(injury = as.factor(injury)) %>%
group_by(county, injury) %>%
summarize(counts = n(), .groups = 'keep') %>%
filter(injury == "fatal")
sharks %>%
mutate(injury = as.factor(injury)) %>%
group_by(county, injury) %>%
summarize(count = n(), .groups = 'keep')
sharks %>%
mutate(injury = as.factor(injury)) %>%
group_by(county, injury) %>%
summarize(count = n(), .groups = 'keep') %>%
filter(injury == "fatal", counts == max(count))
sharks %>%
mutate(injury = as.factor(injury)) %>%
group_by(county, injury) %>%
summarize(count = n(), .groups = 'keep') %>%
filter(injury == "fatal", count == max(count))
sharks %>%
mutate(injury = as.factor(injury)) %>%
group_by(county, injury) %>%
summarize(count = n(), .groups = 'keep') %>%
filter(injury == "fatal")
sharks %>%
mutate(injury = as.factor(injury)) %>%
group_by(county, injury) %>%
summarize(count = n(), .groups = 'keep') %>%
filter(injury == "fatal") %>%
arrange(-count)
sharks %>%
mutate(mode = as.factor(mode)) %>%
summarize(counts = n(), .groups = 'keep')
sharks %>%
mutate(mode = as.factor(mode)) %>%
group_by(mode) %>%
summarize(counts = n())
sharks %>%
#mutate(mode = as.factor(mode)) %>%
group_by(mode) %>%
summarize(counts = n())
sharks %>%
group_by(mode) %>%
summarize(counts = n())
sharks %>%
group_by(mode) %>%
summarize(incidents = n())
sharks %>%
group_by(mode) %>%
summarize(incidents = n()) %>%
arrange(-incidents)
sharks %>%
#mutate(injury = as.factor(injury)) %>%
group_by(county, injury) %>%
summarize(count = n(), .groups = 'keep')
sharks %>%
group_by(county, injury) %>%
summarize(count = n(), .groups = 'keep')
sharks %>%
group_by(county, injury) %>%
summarize(count = n(), .groups = 'keep') %>%
filter(injury == "fatal") %>%
arrange(-count)
#San Luis Obispo has the highest number of fatalities - 3.
sharks %>%
ggplot(aes(x = injury))+
geom_bar()+
facet_wrap(~mode)
sharks %>%
ggplot(aes(x = injury))+
geom_bar()+
facet_wrap(~mode)+
axis.text.x = element_text(angle = 60, hjust=1)
sharks %>%
ggplot(aes(x = injury))+
geom_bar()+
facet_wrap(~mode)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks %>%
ggplot(aes(x = injury))+
geom_bar()+
facet_wrap(~mode)+
coord_flip()
#theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks %>%
ggplot(aes(x = injury))+
geom_bar()+
facet_wrap(~mode)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks %>%
ggplot(aes(x = injury))+
geom_bar()+
facet_wrap(~mode)+
labs(title = "Injuries by Activity", x = "Injury Type", y = "Count")+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1.5), hjust=.5))
sharks %>%
group_by(species) %>%
summarize(incidents = n())
sharks %>%
group_by(species) %>%
summarize(incidents = n()) %>%
arrange(-incidents)
sharks %>%
group_by(species) %>%
summarize(incidents = n()) %>%
filter(incidents == max(incidents))
sharks %>%
filter(species == "White") %>%
ggplot(aes(x = injury))+
geom_bar()
sharks %>%
filter(species == "White") %>%
ggplot(aes(x = injury))+
geom_bar()+
labs(title = "Great White Injuries", x = "Ijury Type", y = "Count")+
theme(plot.title=element_text(size=rel(1.5), hjust=.5))
sharks %>%
filter(species == "White") %>%
ggplot(aes(x = injury))+
geom_bar()+
labs(title = "Great White Injuries", x = "Injury Type", y = "Count")+
theme(plot.title=element_text(size=rel(1.5), hjust=.5))
white_sharks <- read_csv("data/White sharks tracked from Southeast Farallon Island, CA, USA, 1999 2004.csv", na = c("?", "n/a")) %>% clean_names()
glimpse(white_sharks)
View(white_sharks)
white_sharks %>%
group_by(sex) %>%
summarize(mean_length = mean(total_length_cm))
white_sharks %>%
group_by(sex) %>%
summarize(mean_length = mean(total_length_cm))
white_sharks %>%
ggplot(aes(x = sex, y = total_length_cm))+
geom_boxplot()
white_sharks %>%
ggplot(aes(x = sex, y = total_length_cm))+
geom_boxplot(na.rm = T)
white_sharks %>%
filter(sex!= "NA") %>%
ggplot(aes(x = sex, y = total_length_cm))+
geom_boxplot()
sharks %>%
filter(species == "White") %>%
ggplot(aes(x = injury))+
geom_bar()+
labs(title = "Great White Injuries", x = "Injury Type", y = "Count")+
theme(plot.title=element_text(size=rel(1.5), hjust=.5))
white_sharks %>%
filter(sex!= "NA") %>%
ggplot(aes(x = sex, y = total_length_cm))+
geom_boxplot()+
labs(title = "Length Distribution by Sex", x = "Sex", y = "Length (cm)")+
theme(plot.title = element_text(size = rel(1.5), hjust = 0.5))
sharks <- read_csv("data/SharkIncidents_1950_2022_220302.csv") %>% clean_names()
View(sharks)
sharks <- sharks %>%
replace_with_na(replace = list(incident_num = "NOT COUNTED",
time = "Unknown",
species = "Unknown"))
sharks %>%
replace_with_na_all(replace = list(incident_num = "NA"))
sharks %>%
rm(incident_num == "NA")
rm(sharks, incident_num == "NA")
sharks <- sharks %>%
filter(incident_num != "NA")
sharks %>%
ggplot(aes(x = county))+
geom_bar()+
coord_flip()+
labs(title = "Incidents by County", x = "County", y = "Count")+
theme(plot.title=element_text(size=rel(1.5), hjust=.5))
sharks%>%
mutate(month = as.factor(month)) %>%
ggplot(aes(x = month))+
geom_bar()+
labs(title = "Incidents by Month", x = "Month", y = "Count")+
theme(plot.title=element_text(size=rel(1.5), hjust=.5))
sharks %>%
group_by(county, injury) %>%
summarize(count = n(), .groups = 'keep')
sharks %>%
group_by(county, injury) %>%
summarize(count = n(), .groups = 'keep') %>%
filter(injury == "fatal") %>%
arrange(-count)
sharks %>%
group_by(mode) %>%
summarize(incidents = n()) %>%
arrange(-incidents)
sharks %>%
ggplot(aes(x = injury))+
geom_bar()+
facet_wrap(~mode)+
labs(title = "Injuries by Activity", x = "Injury Type", y = "Count")+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1.5), hjust=.5))
sharks %>%
group_by(species) %>%
summarize(incidents = n()) %>%
filter(incidents == max(incidents))
sharks %>%
filter(species == "White") %>%
ggplot(aes(x = injury))+
geom_bar()+
labs(title = "Great White Injuries", x = "Injury Type", y = "Count")+
theme(plot.title=element_text(size=rel(1.5), hjust=.5))
glimpse(white_sharks)
white_sharks %>%
group_by(sex) %>%
summarize(mean_length = mean(total_length_cm))
white_sharks %>%
filter(sex!= "NA") %>%
ggplot(aes(x = sex, y = total_length_cm))+
geom_boxplot()+
labs(title = "Length Distribution by Sex", x = "Sex", y = "Length (cm)")+
theme(plot.title = element_text(size = rel(1.5), hjust = 0.5))
sharks %>%
separate(time, into = c("Hour", "Minute"), sep = ":")
sharks %>%
separate(time, into = c("hour", "minute"), sep = ":")
glimpse(sharks)
#I see an "Unknown" under time/species and "NOT COUNTED" under incident_num
# sort "afternoon" and "early am" into categories
time_assign <- sharks %>%
if_else(time == "afternoon", "14:00", time) %>%
if_else(time == "early am", "5:00", time)
# sort "afternoon" and "early am" into categories
time_assign <- sharks %>%
ifelse(time == "afternoon", "14:00", time) %>%
ifelse(time == "early am", "5:00", time)
View(sharks)
# sort "afternoon" and "early am" into categories
time_assign <- sharks %>%
mutate(time_new = ifelse(time == "afternoon", "14:00", time)) %>%
mutate(time_new = ifelse(time == "early am", "5:00", time))
View(time_assign)
# sort "afternoon" and "early am" into categories
time_assign <- sharks %>%
mutate(time_new = if_else(time == "afternoon", "14:00", time))
# sort "afternoon" and "early am" into categories
time_assign <- sharks %>%
filter(time == "early am") %>%
mutate(time = "5:00")
# sort "afternoon" and "early am" into categories
time_assign <- sharks %>%
filter(time == "early am") %>%
mutate(time = "5:00")
time_assign2 <- sharks %>%
filter(time == "afternoon") %>%
mutate(time = "14:00")
View(time_assign2)
sharks %>%
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
mutate(time_of_day = case_when(hour <= 6 ~ "early morning",
hour > 6 & hour <= 12 ~ "morning",
hour > 12 & hour <= 19 ~ "afternoon",
hour > 19 & hour <= 21 ~ "evening",
hour > 21 & hour <= 23 ~ "night")
# times- early morning: 0-6, morning: 7-12, afternoon: 13-18, evening: 19-21, night: 22-23
sharks %>%
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
mutate(time_of_day = case_when(hour <= 6 ~ "early morning",
hour > 6 & hour <= 12 ~ "morning",
hour > 12 & hour <= 19 ~ "afternoon",
hour > 19 & hour <= 21 ~ "evening",
hour > 21 & hour <= 23 ~ "night"))
# times- early morning: 0-6, morning: 7-12, afternoon: 13-18, evening: 19-21, night: 22-23
sharks %>%
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
mutate(time_of_day = case_when(hour <= 6 ~ "early morning",
hour > 6 & hour <= 12 ~ "morning",
hour > 12 & hour <= 19 ~ "afternoon",
hour > 19 & hour <= 21 ~ "evening",
hour > 21 & hour <= 23 ~ "night")) %>%
# times- early morning: 0-6, morning: 7-12, afternoon: 13-18, evening: 19-21, night: 22-23
ggplot(aes(x = time_of_day))+
geom_histogram()
sharks %>%
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
mutate(time_of_day = case_when(hour <= 6 ~ "early morning",
hour > 6 & hour <= 12 ~ "morning",
hour > 12 & hour <= 19 ~ "afternoon",
hour > 19 & hour <= 21 ~ "evening",
hour > 21 & hour <= 23 ~ "night")) %>%
# times- early morning: 0-6, morning: 7-12, afternoon: 13-18, evening: 19-21, night: 22-23
ggplot(aes(x = time_of_day))+
geom_bar()
sharks %>%
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
mutate(time_of_day = case_when(hour <= 6 ~ "early morning",
hour > 6 & hour <= 12 ~ "morning",
hour > 12 & hour <= 19 ~ "afternoon",
hour > 19 & hour <= 21 ~ "evening",
hour > 21 & hour <= 23 ~ "night")) %>%
# times- early morning: 0-6, morning: 7-12, afternoon: 13-18, evening: 19-21, night: 22-23
ggplot(aes(x = time_of_day))+
geom_bar(na.rm = T)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>%
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
mutate(time_of_day = case_when(hour <= 6 ~ "early morning",
hour > 6 & hour <= 12 ~ "morning",
hour > 12 & hour <= 19 ~ "afternoon",
hour > 19 & hour <= 21 ~ "evening",
hour > 21 & hour <= 23 ~ "night")) %>%
# times- early morning: 0-6, morning: 7-12, afternoon: 13-18, evening: 19-21, night: 22-23
ggplot(aes(x = time_of_day))+
geom_bar()
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram()
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(binwidth = 10)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(binwidth = 5)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(binwidth = 2)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(binwidth = 1)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented/unknown times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(color = "black", fill = "aquamarine4", binwidth = 1)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented/unknown times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(color = "black", fill = "aquamarine4", binwidth = 2)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented/unknown times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(color = "black", fill = "aquamarine4", binwidth = 1)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented/unknown times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(color = "black", fill = "lightskyblue3", binwidth = 1)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented/unknown times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.factor(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(color = "black", fill = "lightskyblue3", binwidth = 1)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented/unknown times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(color = "black", fill = "lightskyblue3", binwidth = 1)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented/unknown times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(color = "black", fill = "lightskyblue3", binwidth = 1)+
geom_density(color = "maroon")
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented/unknown times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(aes(y = after_stat(density)), color = "black", fill = "lightskyblue3", binwidth = 1)+
geom_density(color = "maroon")
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented/unknown times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(color = "black", fill = "lightskyblue3", binwidth = 1)
sharks %>%
filter(time != "NA", time != "early am", time != "afternoon") %>% #get rid of poorly represented/unknown times
separate(time, into = c("hour", "minute"), sep = ":") %>%
mutate(hour = as.numeric(hour)) %>%
ggplot(aes(x = hour))+
geom_histogram(color = "black", fill = "lightskyblue3", binwidth = 1)+
labs(title = "Distribution of Incidents By Time of Day", x = "Hour (24 hour time)", y = "Number of Incidents")+
theme(plot.title = element_text(size = rel(1.5), hjust = 0.5))
